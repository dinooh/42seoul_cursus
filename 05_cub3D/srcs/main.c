# include "cub.h"

/* main funcs */
void			ft_map(t_cub *cub)
{
	int			src[MH][MW] = {
					{4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7},
  					{4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,7},
  					{4,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7},
  					{4,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7},
  					{4,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,7},
  					{4,0,4,0,0,0,0,5,5,5,5,5,5,5,5,5,7,7,0,7,7,7,7,7},
  					{4,0,5,0,0,0,0,5,0,5,0,5,0,5,0,5,7,0,0,0,7,7,7,1},
  					{4,0,6,0,0,0,0,5,0,0,0,0,0,0,0,5,7,0,0,0,0,0,0,8},
  					{4,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,1},
  					{4,0,8,0,0,0,0,5,0,0,0,'E',0,0,0,5,7,0,0,0,0,0,0,8},
  					{4,0,0,0,0,0,0,5,0,0,0,0,0,0,0,5,7,0,0,0,7,7,7,1},
  					{4,0,0,0,0,0,0,5,5,5,5,0,5,5,5,5,7,7,7,7,7,7,7,1},
  					{6,6,6,6,6,6,6,6,6,6,6,0,6,6,6,6,6,6,6,6,6,6,6,6},
  					{8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4},
  					{6,6,6,6,6,6,0,6,6,6,6,0,6,6,6,6,6,6,6,6,6,6,6,6},
  					{4,4,4,4,4,4,0,4,4,4,6,0,6,2,2,2,2,2,2,2,3,3,3,3},
  					{4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,0,0,0,2},
  					{4,0,0,0,0,0,0,0,0,0,0,0,6,2,0,0,5,0,0,2,0,0,0,2},
  					{4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,2,0,2,2},
  					{4,0,6,0,6,0,0,0,0,4,6,0,0,0,0,0,5,0,0,0,0,0,0,2},
  					{4,0,0,5,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,2,0,2,2},
  					{4,0,6,0,6,0,0,0,0,4,6,0,6,2,0,0,5,0,0,2,0,0,0,2},
  					{4,0,0,0,0,0,0,0,0,4,6,0,6,2,0,0,0,0,0,2,0,0,0,2},
  					{4,4,4,4,4,4,4,4,4,4,1,1,1,2,2,2,2,2,2,3,3,3,3,3}
				};

	ft_memcpy(cub->map, src, sizeof(int) * MH * MW);
}

int				main(int argc, char **argv)
{
	t_cub		cub;

	if (argc > 3)
		printf("wrong usage\n");
	// else if (argc == 2)
	// 	// --save
	else
	{
		cub.mlx = mlx_init();
		cub.texture = (int **)malloc(sizeof(int *) * 8);
		for (int i = 0; i < 8; i++)
			cub.texture[i] = (int *)malloc(sizeof(int) * (TW * TH));
		for (int i = 0; i < 8; i++){
			for (int j = 0; j < TW * TH; j++)
				cub.texture[i][j] = 0;
		}
		load_texture(&cub);
		ft_screen(&cub);
		ft_map(&cub);
		ft_player(&cub);
		cub.img.data = (int *)mlx_get_data_addr(cub.img.img, &cub.img.bpp, &cub.img.size_line, &cub.img.endian);
		ft_raycasting(&cub);
		mlx_hook(cub.win, EVENT_KEY_PRESS, 0, ft_key_press, &cub);
		mlx_hook(cub.win, EVENT_EXIT, 0, ft_exit, &cub);
		mlx_loop_hook(cub.mlx, ft_raycasting, &cub);
		mlx_loop(cub.mlx);
	}
	return (0);
}
